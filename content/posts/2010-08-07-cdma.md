---
date: "2010-08-07T00:00:00Z"
tags: 
title: CDMA手机写号常识
---

RT @<http://tinyurl.com/24l3gsx>

从添翼圈获得了Hero200手机了，可是这个手机是写号的，所以，折腾半天，就得开始研究
怎么给这个手机写号了，但是从来没搞过写号啊，什么是写号啊，还先得给自己补充补充
这方面的知识，毕竟本人不是后端的，呵呵。从网上找了这么一些文章，经过学习，大体
掌握了什么是写号，才明白改卡机，真是难为水货商家们了。

## 一、三码的定义

经常看见水货手机商卖手机的同时还要查询什么三码，这三码即IMSI、ESN、A-Key。因为
这些手机是不具备UIM卡卡槽的，国外的CDMA手机大部分是通过直接写号，即将UIM卡的信
息写入手机里来实现手机入网通讯的。很典型的例子，本地的小灵通才出来的时候就是使
用写号的方式，这些小灵通不具备卡槽，当时我跟我爸去营业厅办理小灵通就是看前台营
业员在电脑上操作以后，就可以使用该小灵通了，所谓的烧号，也就进一步证明当时本地
的小灵通是高通的CDMA网络，非PHS。而在国内，据说是为了方便用户，和G网接轨，也弄
个卡出来，即UIM卡，那么UIM卡上就用来保存这些相关的入网验证信息。下面来一个个简
单解释，有些内容是从其他文章转来的，懒得写了。

* ESN：这是一个8位编码，由英文字母和数字进行混合编码，这个编码也叫机身码，其实
  世界上 任何一部手机终端出厂时都有这个编码，这个编码代表了一部手机唯一的身份标
  识。顺便说一下，可能一些已经买到机器的朋友说我怎么找不到这个编码呀，虽然这 8
  位数的编码资源全世界通用，每生产一部手机就要消耗一个编码，这个编码短期内又几
  乎不可回收再利用，编码资源已经接近耗尽的边缘，国外的CDMA运营商 已经采取新的编
  码方式，扩展为14位的英文数字混合编码，也有了新的名称MEID。国内因为使用UIM卡，
  一个用户配置的UIM卡的ESN只有一个，所以对资源的消耗相对较小，所以暂时没 有对
  MEID的需求。问题来了，那么国外用MEID，国内用ESN，岂不是不兼容，呵呵，其实任何
  一个    MEID都可以换算为ESN的，这种换算出来的ESN都是以80开头，而且由MEID换算
  出来的ESN在国内是可以正常使用的，需要注意的是普通的ESN 编码是不能逆向换算成
  MEID的，这种换算是单向不可逆的！

* IMSI：这个编码也叫国际移动用 户识别码， 这个编码是由15位数字组成 的， 比如：
  460 03   1234567890，其中460是国家代码（专有名称MCC）、   03是运营商代码（专
  有名称MNC）、1234567890是用户身份码（专有 名称MSID）， 我们常见的手机号码比如
  133 0123      0123其实只是系统对外的业务码，真正在系统中确认一个用户身份还是
  10位的MSID码，MSID和你的手机号码在运营系统中是一个配对的关系，这个对    应关
  系是唯一的的。通过  MCC+MNC+MSID就完成了一个手机用户在国际上唯一的身份识别，
  就如同我们的身份证一样，绝对唯一的。（说明一下：前面提到的MCC代码460就是中国
  的国家代码，MNC代码03就是中国电信的代码，这2个号码大 家以后写号入网肯定要用到
  ，先记下来吧）

* A-Key：这个编码叫*鉴权密钥*，理解起来很简单也就是对用户身份进行验证核对的密码
  。这个编码比较 长有16位数字英文混合。

只要具备以上三码，手机就可以入网，就可以进行基本的通讯业务，如语音和短信等。利
用现阶段一些工具，如进入手机的手编模式等，是可以轻松查看 到IMSI、ESN两个码的，
但是A-Key是看不到的，经过加密等等很复杂的方式保存于UIM卡上的，正常情况下是无法
读出的。但是现在比较热门的3G 呢？电信的就是EVDO，单单具备这三码是不够的，还必须
要AN和AAA码，即所谓的五码。

## 二、EVDO验证

上一点提到了五码，多出来了AN和AAA，前者是账号，后者是密码，即手机终端能够使用
EVDO网络的前提。EVDO的标准认证模 式有2种，分别是MD5认证和CAVE认 证，下面就来说
一下认证模式的区别。

* MD5：这种认证模式是CDMA规    范最早的EV-DO认证模式，通用于所有的CDMA网络，简
  单来说MD5认证模式就是：认证账号  (AN)+认证密码 (AAA)，通过该账号密码同后台系
  统中存在的账号密码进行比对，来确认用户的身份，当认证通过时，系统将为用户开通
  EV-DO服务。标准 规范名称也叫AN/AAA，其中AN一般都是用户的15 位  IMSI码，AAA各
  地的密码模式都不一  样，国内一些省市使用通用的6个1或者其他通用口令作为密码，
  有些区域使用12位随机英文作为密码。之前我就写过一篇<a
  href="http://www.laozhe.net/articles/68.html" target="_blank">《VX6900升级 3G
  上EVDO网络简要教程》</a>，里面就提到了AN和AAA。

* CAVE：这个是国内使用UIM卡时使用的专用认证算法，该算法通过 ESN、   A-KEY及从网
  络收到的随机数作为CAVE算法的输入、通过一系列复杂的运算，输出一个用于验证的结
  果值。这个算法的好处是安全性高，除非UIM卡遗 失，要不是无法*的。

综上所述：MD5具有极高的通用性，只要获取AN/AAA就能在任何终端上进行上网，但是相对
安全性较差，CAVE认证具有极高的安全性，但只 能在国内的UIM卡及网络上运行，通用性
不如MD5强。（只要知道AN/AAA就可以写入任何一部手机中进行EVDO业务的使用，可以不用
管电话号码是否 上网号相同）。

## 三、总结
* 基本通讯功能：IMSI、ESN、A-Key
* EVDO上网功能：AN、AAA

